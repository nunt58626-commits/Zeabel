<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
  <title>บันทึกการเคลื่อนย้ายสินค้า</title>
  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body style="background-color: rgba(185, 195, 255, 0.64);">
<nav class="navbar navbar-dark fixed-top" style="background-color: #292755;">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">บันทึกการเคลื่อนย้ายสินค้า ST1</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNavbar">
      <div class="offcanvas-header" style="background-color: rgba(185, 195, 255, 0.64);">
        <h5 class="offcanvas-title">เมนู</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas"></button>
      </div>
      <div class="offcanvas-body" style="background-color: #292755;">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link active" href="index.html">บันทึกสินค้า</a></li>
          <li class="nav-item"><a class="nav-link" href="save.html">ประวัติสินค้า</a></li>
        </ul>
      </div>
    </div>
  </div>
</nav>

<div class="container mt-5 pt-5">
  <form id="movementForm">
    <div class="mb-3">
      <label for="productCode" class="form-label">รหัสสินค้า</label>
      <input type="text" class="form-control" id="productCode" required>
    </div>
    <div class="mb-3">
      <label for="quantity" class="form-label">จำนวนลัง</label>
      <input type="number" class="form-control" id="quantity" min="1" required>
    </div>
    <div class="mb-3">
      <label for="mfgDate" class="form-label">วันผลิต</label>
      <input type="date" class="form-control" id="mfgDate" required>
    </div>
    <div class="mb-3">
      <label for="expDate" class="form-label">วันหมดอายุ</label>
      <input type="date" class="form-control" id="expDate" required>
    </div>
    <div class="mb-3">
      <label for="locationFrom" class="form-label">จากตำแหน่ง</label>
      <select class="form-select" id="locationFrom" required>
        <option selected disabled value="">เลือกตำแหน่ง</option>
        <option value="นอกคลัง">นอกคลัง</option>
        <option value="แถวที่ 1 ซ้าย">แถวที่ 1 ซ้าย</option>
        <option value="แถวที่ 1 ขวา">แถวที่ 1 ขวา</option>
        <!-- เพิ่มได้ตามต้องการ -->
      </select>
    </div>
    <div class="mb-3">
      <label for="locationTo" class="form-label">ไปตำแหน่ง</label>
      <select class="form-select" id="locationTo" required>
        <option selected disabled value="">เลือกตำแหน่ง</option>
        <option value="นอกคลัง">นอกคลัง</option>
        <option value="แถวที่ 1 ซ้าย">แถวที่ 1 ซ้าย</option>
        <option value="แถวที่ 1 ขวา">แถวที่ 1 ขวา</option>
      </select>
    </div>
    <div class="d-grid gap-2 col-6 mx-auto">
      <button type="submit" class="btn btn-primary">บันทึก</button>
    </div>
  </form>
</div>

<script>
document.getElementById('movementForm').addEventListener('submit', function(event) {
  event.preventDefault();

  const formData = {
    productCode: document.getElementById('productCode').value.trim(),
    quantity: parseInt(document.getElementById('quantity').value),
    mfgDate: document.getElementById('mfgDate').value,
    expDate: document.getElementById('expDate').value,
    locationFrom: document.getElementById('locationFrom').value,
    locationTo: document.getElementById('locationTo').value,
    timestamp: new Date().toISOString()
  };

  if (formData.expDate <= formData.mfgDate) {
    alert('วันหมดอายุต้องมากกว่าวันผลิต');
    return;
  }

  if (formData.locationFrom === formData.locationTo) {
    alert('ตำแหน่งจากและไปต้องไม่เหมือนกัน');
    return;
  }

  const existingData = JSON.parse(localStorage.getItem('stockMovements')) || [];
  existingData.push(formData);
  localStorage.setItem('stockMovements', JSON.stringify(existingData));

  alert('บันทึกข้อมูลเรียบร้อยแล้ว!');
  this.reset();
});
</script>
</body>
</html>
